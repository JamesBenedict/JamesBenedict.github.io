YUI.add("hermes-template-photo-list-photo-interaction",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;r+='\n		<div class="extra-tools">\n			',i=n["if"].call(e,e.removeToolClass,{hash:{},inverse:l.noop,fn:l.program(2,p,t),data:t});if(i||i===0)r+=i;r+="\n			",i=n["if"].call(e,e.excludePeopleToolTitle,{hash:{},inverse:l.noop,fn:l.program(4,d,t),data:t});if(i||i===0)r+=i;return r+="\n		</div>\n	",r}function p(e,t){var r="",i;return r+='\n				<div class="extra-tool remove-photo ',(i=n.removeToolClass)?i=i.call(e,{hash:{},data:t}):(i=e.removeToolClass,i=typeof i===a?i.apply(e):i),r+=f(i)+'" data-id='+f((i=(i=e.photo,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+"></div>\n			",r}function d(e,t){var r="",i,s;return r+='\n				<div class="extra-tool exclude-person" data-id='+f((i=(i=e.photo,i==null||i===!1?i:i.id),typeof i===a?i.apply(e):i))+' title="',(s=n.excludePeopleToolTitle)?s=s.call(e,{hash:{},data:t}):(s=e.excludePeopleToolTitle,s=typeof s===a?s.apply(e):s),r+=f(s)+'"></div>\n			',r}function v(e,t){var r="",i;r+='\n		<div class="curator-tools">\n			',i=n.each.call(e,e.curatorTools,{hash:{},inverse:l.noop,fn:l.program(7,m,t),data:t});if(i||i===0)r+=i;return r+="\n			</ul>\n		</div>\n	",r}function m(e,t){var n="",r;return n+='\n				<li>\n					<i class="ui-icon-curator-'+f((r=e.name,typeof r===a?r.apply(e):r))+'"></i>\n				</li>\n			',n}function g(e,t){var n;return f((n=(n=e.photo,n==null||n===!1?n:n.title),typeof n===a?n.apply(e):n))}function y(e,t){var r,i;return i={hash:{intlName:"common.UNTITLED"},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):c.call(e,"intlMessage",i)))}function b(e,t){var r="",i,s;return r+=" ",s={hash:{intlName:"common.BY_YOU"},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s))),r}function w(e,t){var r="",i,s;return r+=" ",s={hash:{intlName:"common.BY_USER",user:(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.username)},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s))),r}function E(e,t){var r="",i,s;r+="\n				",s=n["if"].call(e,(i=e.photo,i==null||i===!1?i:i.title),{hash:{},inverse:l.program(20,x,t),fn:l.program(18,S,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.displayname),{hash:{},inverse:l.program(27,k,t),fn:l.program(22,T,t),data:t});if(s||s===0)r+=s;return r+="\n			",r}function S(e,t){var r="",i;return r+='\n					<a href="',(i=n.photoPageUrl)?i=i.call(e,{hash:{},data:t}):(i=e.photoPageUrl,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="title">'+f((i=(i=e.photo,i==null||i===!1?i:i.title),typeof i===a?i.apply(e):i))+"</a>\n				",r}function x(e,t){return'\n					<span class="title empty"> </span>\n				'}function T(e,t){var r="",i,s;r+='\n					<a href="'+f((i=(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.url),typeof i===a?i.apply(e):i))+'" class="attribution">',s=n["if"].call(e,(i=e.photo,i==null||i===!1?i:i.isOwner),{hash:{},inverse:l.program(25,C,t),fn:l.program(23,N,t),data:t});if(s||s===0)r+=s;return r+="</a>\n				",r}function N(e,t){var r,i;return i={hash:{intlName:"common.BY_YOU"},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):c.call(e,"intlMessage",i)))}function C(e,t){var r,i;return i={hash:{intlName:"common.BY_USER",user:(r=(r=e.photo,r==null||r===!1?r:r.owner),r==null||r===!1?r:r.username)},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):c.call(e,"intlMessage",i)))}function k(e,t){return'\n					<span class="attribution empty"> </span>\n				'}function L(e,t){return'\n				<span class="title empty"> </span>\n				<span class="attribution empty"> </span>\n			'}function A(e,t){return" faved"}function O(e,t){return" fave"}function M(e,t){return" can-not-fave"}function _(e,t){var r="",i;return r+='<span class="icon-count">',(i=n.faveCount)?i=i.call(e,{hash:{},data:t}):(i=e.faveCount,i=typeof i===a?i.apply(e):i),r+=f(i)+"</span>",r}function D(e,t){var r="",i;return r+='<span class="icon-count">',(i=n.commentCount)?i=i.call(e,{hash:{},data:t}):(i=e.commentCount,i=typeof i===a?i.apply(e):i),r+=f(i)+"</span>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.helperMissing;s+='\n<div class="photo-list-photo-interaction">\n	<a class="overlay" href="',(o=n.photoPageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.photoPageUrl,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></a>\n	',o=n["if"].call(t,t.hasExtraFunctionality,{hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.curatorTools,{hash:{},inverse:l.noop,fn:l.program(6,v,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="interaction-bar" title="',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.title),{hash:{},inverse:l.program(11,y,i),fn:l.program(9,g,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.isOwner),{hash:{},inverse:l.program(15,w,i),fn:l.program(13,b,i),data:i});if(u||u===0)s+=u;s+='">\n		<div class="text">\n			',u=n["if"].call(t,t.displayTitleAndAttribution,{hash:{},inverse:l.program(29,L,i),fn:l.program(17,E,i),data:i});if(u||u===0)s+=u;s+='\n		</div>\n\n		<div class="tool">\n			<a href="',(u=n.photoPageUrl)?u=u.call(t,{hash:{},data:i}):(u=t.photoPageUrl,u=typeof u===a?u.apply(t):u),s+=f(u)+'" class="fave-area">\n				<i class="fave-star',u=n["if"].call(t,t.isFaved,{hash:{},inverse:l.program(33,O,i),fn:l.program(31,A,i),data:i});if(u||u===0)s+=u;u=n.unless.call(t,t.canFave,{hash:{},inverse:l.noop,fn:l.program(35,M,i),data:i});if(u||u===0)s+=u;s+='"></i>',u=n["if"].call(t,t.faveCount,{hash:{},inverse:l.noop,fn:l.program(37,_,i),data:i});if(u||u===0)s+=u;s+='\n			</a>\n		</div>\n\n		<div class="tool">\n			<a href="',(u=n.photoPageUrl)?u=u.call(t,{hash:{},data:i}):(u=t.photoPageUrl,u=typeof u===a?u.apply(t):u),s+=f(u)+'" class="comment-area">\n				<i class="comments"></i>',u=n["if"].call(t,t.commentCount,{hash:{},inverse:l.noop,fn:l
.program(39,D,i),data:i});if(u||u===0)s+=u;return s+="\n			</a>\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-list-photo-interaction",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-list-photo-interaction-view",function(e){"use strict";var t={css:{faveClickArea:".fave-area",removeFaveTool:"remove-fave",removePoolTool:"remove-group-pool",scotchPhotoTool:"scotch-photo"}},n=25,r=20,i=10,s=75;e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t=this.appContext.getViewer();return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),(!t.signedIn||e.nsid!==t.nsid)&&this.set("viewingSelf",!1),this.params=e,this},loadState:function(){var n=[],r=this.get("listModelParams");return n.push(this.appContext.getModel(this.get("engagementModelName"),this.get("id"))),r&&n.push(this.appContext.getModel(r.registryName,r.modelIdOrAttributes)),e.Promise.all(n).then(function(e){var n=e[0],r=e[1];this.set("engagement",n),this.extraFunctionality={},this.params.removeOwnFaves?this.get("model").getValue("isOwner")&&!this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=t.css.removeFaveTool):this.params.removePoolPhoto?this.get("model").getValue("isOwner")?this.extraFunctionality.removeToolClass=t.css.removePoolTool:r&&(r.getValue("group").getValue("isAdmin")||r.getValue("group").getValue("isModerator"))&&(this.extraFunctionality.removeToolClass=t.css.removePoolTool):this.params.scotchPhotos&&(this.extraFunctionality.removeToolClass=t.css.scotchPhotoTool),this.params.excludePeople&&(this.extraFunctionality.excludePeopleToolTitle=this.intlMessage({intlName:"common.HIDE_PHOTOS_FROM_PERSON"})),this.params.scotchPeople&&(this.extraFunctionality.excludePeopleToolTitle=this.godMessage({intlName:"explore.REMOVE_PERSON_FROM_EXPLORE"}))}.bind(this))},buildContainer:function(e){var t=this.get("engagement"),o=t.getValue("faveCount"),u=t.getValue("isFaved"),a=t.getValue("canFave"),f=t.getValue("commentCount"),l=55,c=!0;return o>=100?l+=n:o>=10?l+=r:o>0&&(l+=i),f>=100?l+=n:f>=10?l+=r:f>0&&(l+=i),this.get("layoutWidth")-l<s&&(c=!1),e=e||{},o=o<100?o:"99+",f=f<100?f:"99+",e.photo=this.get("model").toJSON(),e.photoPageUrl=this.get("photoPageUrl"),e.faveCount=o,e.isFaved=u,e.canFave=a,e.commentCount=f,e.displayTitleAndAttribution=c,e.hasExtraFunctionality=Object.keys(this.extraFunctionality).length>0,e.removeToolClass=this.extraFunctionality.removeToolClass,e.excludePeopleToolTitle=this.extraFunctionality.excludePeopleToolTitle,e.curatorTools=this.getCuratorTools(),this.setContainerHTML(this.templates("photo-list-photo-interaction")(e)),this},activate:function(){var e=this.get("engagement"),n=this.get("container");return this.get("engagement").getValue("canFave")&&(this.registerEventHandler(e.on("valuesChanged",this.faveStarChanged.bind(this))),this.registerEventHandler(n.delegate("click",this.faveStarClicked.bind(this),t.css.faveClickArea))),this},getCuratorTools:function(){if(!this.appContext.flipper.isFlipped("enable-curator-tools")||!this.appContext.getViewer().isInsecureGod)return null;var e=this.get("model"),t=e&&e.getValue("curation"),n=[];return t?(["is3MP","ownerCountryApproved","ownerFollowedByCurators","ownerAdded","ownerPassedOver"].forEach(function(e){t.getValue(e)&&n.push({name:e})}),n):null},faveStarClicked:function(t){var n=this.appContext.getViewer(),r=this.get("engagement"),i,s,o=this;n&&n.signedIn?this.get("isFaving")||(this.set("isFaving",!0),r.toggleFave(),r.remoteUpdate().then(function(){this.appContext.getModelRegistry("favorite-models").then(function(e){e.proxy(n.nsid).getValue("photoPageList").remove(o.get("model"))}),this.set("isFaving",!1)}.bind(this),function(e){e.code!==3&&r.toggleFave(),this.set("isFaving",!1)}.bind(this))):(i=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),htmlMessage:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_MESSAGE"}),actionButtonLabel:this.intlMessage({intlName:"fave-view.SIGN_IN_AND_FAVE"}),cancelButtonLabel:this.intlMessage({intlName:"common.CANCEL"})}),i.on("actionClick",function(){s=e.URLHelper.getPhotoPage({photoId:r.getValue("id"),pathAlias:r.getValue("ownerNsid")}),e.SigninHelper.addPendingFave({id:r.getValue("id")},{postLoginUrl:e.url(s)})}),i.show()),t.halt()},faveStarChanged:function(e){(e.faveCount!==undefined||e.isFaved!==undefined||e.canFave!==undefined)&&this.buildContainer()},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(t,n){return e.TypeValidator.matches.photoId(t)}},model:{writeOnce:"initOnly"},listModelParams:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"},engagement:{value:null},viewingSelf:{value:!0},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,n){return e.AttributeHelpers.validateString(t)}},layoutWidth:{validator:function(t,n){return e.AttributeHelpers.validateFloat(t)},setter:function(t){return e.AttributeHelpers.coerceFloat(t)||undefined},defaultFn:function(e){return 0}},isFaving:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-photo-interaction","photo-list-photo-interaction-css","type-validator","attribute-helpers","fluid-modal-view","url","flickrui-css"],optionalRequires:["fluid"],langBundles:["fave-view","common"]});
YUI.add("hermes-lang-fave-view",function(e,t){e.Intl.add("hermes/fave-view","en-US",{COULDNT_FAVE:["We couldn't fave at this time"],SIGN_IN_TO_FAVE:["You must be signed in to fave. Please sign in now."],LOADING_FAVES:["Loading Faves..."],UNFAVE_PHOTO:["Unfave this photo"],FAVE_PHOTO:["Fave this photo"],WHO_FAVED:["Who faved this photo"],SIGN_IN_BEFORE_FAVE_TITLE:["You found a photo to fave!"],SIGN_IN_BEFORE_FAVE_MESSAGE:["That's great. Just sign in to fave it."],SIGN_IN_AND_FAVE:["Sign in and fave"]})},"@VERSION@",{requires:["intl"]});
YUI.add("attribution-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return this.hideFollowView}}},initializer:function(e){return this.nsid=e.nsid,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.realFullscreen=!!e.realFullscreen,this.hideFollowView=e.hideFollowView?e.hideFollowView:!1,this},loadState:function(){var t=this;return e.Promise.all([t.appContext.getModel("person-models",t.nsid)]).then(function(e){t.set("owner",e[0])})},buildContainer:function(){var e=this.get("owner"),t=this.get("container"),n=e.getValue("pathAlias")||e.getValue("nsid"),r,i,s=this;return this.albumPhotoListLayoutStyle==="justified"&&t.addClass("justified-album-details-page"),i=e.getValue("buddyicon").large?e.getValue("buddyicon").large:e.getValue("buddyicon")["default"],r=this.templates("attribution")({isPro:s.appContext.flipper.isFlipped("enable-pro-badge")?e.getValue("isPro"):!1,pathAlias:n,buddyicon:i,nsid:e.getValue("nsid"),displayname:e.getValue("displayname"),follow:this.subviews["follow-view"]?this.subviews["follow-view"].get("container"):"",realFullscreenEnabled:this.realFullscreen&&this.appContext.experiments.fullscreen.getMode()}),this.setContainerHTML(r),this},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","hermes-template-attribution","photo-attribution-css","promise","follow-view"],optional:["person-models"],langBundles:["attribution"]});
YUI.add("album-header-view",function(e){var t=.8,n=480,r=60,i={css:{headerContent:".album-header-content"}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"album-title-desc-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-stats-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-engagement-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,hideFollowView:!0,additionalViewClasses:["album-attribution"]}},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("set-models",this.albumId)),this.appContext.getViewer().signedIn&&n.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid)),e.Promise.all(n).then(function(e){t.set("albumModel",e[0]),e[1]&&t.set("personPreferenceModel",e[1])})},buildContainer:function(){var e,n,i=this.get("container"),s=this.getAlbumHeaderHeight()-r,o=this.get("albumModel"),u=this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===o.getValue("owner").id,a=this.appContext.viewportData.getDevicePixelRatio();return this.albumPhotoListLayoutStyle==="justified"&&(i.addClass("justified-transitions"),i.addClass("justified"),s=300),n=o.registry.getSizeToFit(this.albumId,{width:this.appContext.viewportData.getWidth()*t*a,height:s*a}),e=this.templates("album-header")({"album-title-desc-view":this.subviews["album-title-desc-view"].get("container"),"album-stats-view":this.subviews["album-stats-view"].get("container"),"album-engagement-view":this.subviews["album-engagement-view"].get("container"),"attribution-view":this.subviews["attribution-view"].get("container"),height:s,"cover-photo-url":n.url,viewerIsOwner:u}),this.setContainerHTML(e),this},buildErrorContainer:function(){},activate:function(){var t=this,n=this.get("container"),s=n.one(".edit-cover-photo"),o=n.one(".album-header-content"),u=n.one(".avatar"),a,f=this.get("personPreferenceModel");this.albumHeaderElement=this.get("container").one(i.css.headerContent),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.resizeHeader.bind(this))),s&&this.registerEventHandler(s.on("click",this.handleSetCoverPhotoClick.bind(this))),e.on("albumToolbarView:layoutChange",function(i){f&&(f.setValues({albumViewLayoutPref:i}),f.remoteUpdate()),i==="justified"?(n.addClass("justified-transitions"),n.addClass("justified"),o.setStyle("height",300),u&&e.flutil.onTransitionEnd(u,function(){n.one(".album-attribution").addClass("justified-album-details-page")})):(a=t.getAlbumHeaderHeight()-r+"px",o.setStyle("height",a),n.removeClass("justified"),u&&setTimeout(function(){n.one(".album-attribution").removeClass("justified-album-details-page")},250),e.flutil.onTransitionEnd(o,function(){n.removeClass("justified-transitions")}))})},onSubviewEvent:function(e,t){var n=this.get("container"),r=n.one(".album-header-content"),i=n.one(".edit-cover-photo");if(e==="album-title-desc-view"&&t[0]==="albumTitleDesc:editing")return this.fire("parentViewEvent","albumHeaderView:editing"),i.addClass("hidden"),!1;if(e==="album-title-desc-view"&&t[0]==="albumTitleDesc:doneEditing")return this.fire("parentViewEvent","albumHeaderView:doneEditing"),i.removeClass("hidden"),!1;e==="album-title-desc-view"&&t[0]==="albumTitleDescEditing:heightChange"&&t[1]&&r.setStyle("height",parseInt(r.getComputedStyle("height"),10)+t[1]+"px")},resizeHeader:function(e){var t=this.getAlbumHeaderHeight()-r,n=this.get("container");n.hasClass("justified")||this.albumHeaderElement.setStyle("height",t)},getAlbumHeaderHeight:function(){var e=this.appContext.viewportData.getWidth(),t=this.appContext.viewportData.getHeight()-50,r=1.3,i=2.3,s=2.75,o=120,u=e/r+o,a=e/i+o,f=e/s,l;return t>u?l=e/r:t>a?l=t-o:t>f?l=t-o+o*(t-a)/(f-a):l=t,Math.max(n,Math.round(l))},handleSetCoverPhotoClick:function(n){n.preventDefault();var i=this.get("container"),s=this,o=this.get("albumModel"),u=this.templates("flickr-balls")({}),a=i.one(".edit-cover-photo"),f,l,c,h=this.appContext.viewportData.getDevicePixelRatio();f=new e.Views.FluidModal({appContext:s.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:s.appContext,links:[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream"},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets",selected:!0},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],enableSearch:!0,enableMarketplaceProductsSearch:!1}),actionButtonLabel:this.intlMessage({intlName:"common.SELECT"}),actionButtonDisabled:!0,subview:new e.Views["photo-selector-view"]({appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1},defaultSelected:{id:s.albumId,title:s.get("albumModel").getValue("title"),type:"set"}}),width:752,height:498,fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1}),f.on("actionClick",function(n){a.replace(u);var p=f.get("subview").get("selected");this.appContext.getModel("photo-models",p).then(function(e){return o.hasPhoto(p)===!1?c=o.registry.remote.addPhoto({setID:s.albumId,photoID:p},s.appContext).then(function(){return s.fire("subviewViewEvent","newPhotoAddedToAlbum",p),o.registry.remote.setPrimaryPhoto({photoId:p,albumId:s.albumId},s.appContext)}):c=o.registry.remote.setPrimaryPhoto({photoId:p,albumId:s.albumId},s.appContext),c.then(function(n){l=e.getSizeToFit({width:s.appContext.viewportData.getWidth()*t*h,height:(s.getAlbumHeaderHeight()-r)*h}),o.setValue("primary",e.id),o.setValue("primaryPhotoSizes",e.getValue("sizesForAlbum")),o.setValue("primaryNeedsInterstitial",e.getValue("needsInterstitial"
)),i.one(".album-header-content").setStyle("background-image","url("+l.url+")"),i.one(".balls").replace(a)})}).then(null,function(t){var n=new e.Views.FluidModal({title:s.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:s.intlMessage({intlName:"common.OK"}),textMessage:s.intlMessage({intlName:"album-page.ERROR_COVER_PHOTO"}),appContext:s.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!1,hideModalOverlay:!1,showCancelX:!0});n.show(),i.one(".balls").replace(a)})}),f.registerEventHandler(e.on("photoSelector:selected",function(e){f.enableActionButton()})),f.registerEventHandler(e.on("photoSelector:unselected",function(e){f.disableActionButton()})),e.rapidTracker.beacon(s.name,"albumCoverPhotoEdit"),f.show()}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-header","hermes-template-flickr-balls","album-header-css"],optional:["album-title-desc-view","album-stats-view","album-engagement-view","photo-selector-view","fluid-modal-nav-bar-view","photo-list-photo-interaction-view","attribution-view"],langBundles:["album-page","global-nav","common"]});
YUI.add("album-page-view",function(e){var t=190,n=430,r=null,i=3;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(s){return this.albumId=s.albumId,this.isOwner=s.isOwner,this.isTwitterbot=s.isTwitterbot,this.albumPhotoListLayoutStyle=s.albumPhotoListLayoutStyle,s.id=s.albumId,s.modelRegistryName="set-models",s.maxNumAttrName="totalCount",this.pageParams=s.pageParams,s.photoListConfig={modelParams:{registryName:"set-models",modelIdOrAttributes:s.albumId,collectionAttributeName:"photoPageList"},parentName:this.name,pageParams:s.pageParams,contextSuffix:"album-"+s.albumId,measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:s.withPhotoId},s.photoListConfig.layout={targetRowHeight:this.albumPhotoListLayoutStyle==="justified"?t:n,fullWidthBreakoutRowCadence:this.albumPhotoListLayoutStyle==="justified"?r:i,awakeBoundsToViewportSizeRatio:5,containerPadding:{top:4,right:0,bottom:4,left:0},itemSpacing:{horizontal:4,vertical:4}},this.aftHelper=new e.PhotolistAftHelper(this),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"album-toolbar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-header-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return this.pageParams.viewPageSize?!1:!0}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("set-models",this.albumId).then(function(t){e.set("albumModel",t)})},buildContainer:function(){var e;return e={"global-nav-view":this.subviews["global-nav-view"].get("container"),"album-toolbar-view":this.subviews["album-toolbar-view"].get("container"),"album-header-view":this.subviews["album-header-view"].get("container"),"photo-list-view":this.subviews["photo-list-view"].get("container"),"pagination-view":this.subviews["pagination-view"]?this.subviews["pagination-view"].get("container"):"","footer-full-view":this.subviews["footer-full-view"].get("container"),flippers:this.appContext.flipper.toJSON()},this.setContainerHTML(this.templates("album-page")(e)),this},buildHeadContainer:function(){var t=this.get("albumModel"),n=t.getValue("photoPageList").getList(),r="summary",i=[],s,o=(this.pageParams.nominalPage-1)*this.pageParams.viewPageSizeForShare||0,u,a;if(this.isTwitterbot&&n.length-o>=4){r="gallery";for(a=0;a<Math.min(n.length-o,4);a++)n[o+a]?i.push({property:"twitter:image"+a,content:n[o+a].getSizeToFit({width:640,height:640}).url}):e.Flog.error("[album-page-view] missing album photo in album list: "+(o+a))}t.registry?s=t.registry.getSizeToFit(this.albumId,{width:640,height:640}):e.Flog.error("[album-page-view] Missing album model registry!"),u=this.templates("dynamic-page-head")({title:t.getValue("title"),description:t.getValue("description"),url:t.getValue("url"),fullURL:e.url(t.getValue("url")),openGraphImageURL:e.URLHelper.addProtocolToURL(s.url),openGraphaImageWidth:s.width,openGraphaImageHeight:s.height,ownerURL:t.getValue("owner").getValue("url"),twitterCardType:r,twitterImages:i,flickrType:"set",domain:e.url()}),u+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),u+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, initial-scale=1, maximum-scale=1"}),u+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),YUI.Env.isServer?this.set("headContainer",u):(this.set("headContainer",u.concat(this.subviews["pagination-view"].get("headContainer"))),this.updateHead())},activate:function(){var s=this,o=this.get("albumModel"),u=o.getValue("isOwner");return e.later(100,this,function(){e.use("photo-page-scrappy-view")}),e.on("albumToolbarView:layoutChange",function(e){var o=s.subviews["photo-list-view"],u=o.photoListLayout;u.targetRowHeight=e==="justified"?t:n,u.fullWidthBreakoutRowCadence=e==="justified"?r:i,o.setItems(s.get("albumModel").getValue("photoPageList").getList())}),u||this.appContext.getViewCounter().recordAlbumView({albumOwnerID:o.getValue("owner").getValue("id"),albumID:o.getValue("id"),referrer:this.appContext.getReferrer()}),this},onSubviewEvent:function(e,t){t&&t[0]==="newPhotoAddedToAlbum"&&this.subviews["photo-list-view"].setItems(this.get("albumModel").getValue("photoPageList").getList())},getTrackingSegments:function(){return{vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:792600538}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","set-models","hermes-template-album-page","hermes-template-dynamic-page-head","hermes-template-head-meta","hermes-template-head-link","album-page-css","album-toolbar-view","album-header-view","photo-list-view","footer-full-view","photolist-aft-helper","url-helper"],langBundles:["album-page"]});
